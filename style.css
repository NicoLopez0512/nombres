document.addEventListener("DOMContentLoaded", mostrarHistorial);

function agregarRegistro() {
    const curso = document.getElementById("cursoInput").value.trim();
    const fecha = document.getElementById("fechaInput").value;
    const nombre = document.getElementById("nombreInput").value.trim();

    if (curso === "" || fecha === "" || nombre === "") {
        alert("Debes completar curso, fecha y nombre");
        return;
    }

    let historial = JSON.parse(localStorage.getItem("historial")) || [];

    historial.push({
        curso: curso,
        fecha: fecha,
        nombre: nombre
    });

    localStorage.setItem("historial", JSON.stringify(historial));

    document.getElementById("nombreInput").value = "";
    mostrarHistorial();
}

function mostrarHistorial() {
    const tabla = document.getElementById("tablaRegistros");
    tabla.innerHTML = "";

    let historial = JSON.parse(localStorage.getItem("historial")) || [];

    historial.forEach(registro => {
        const fila = document.createElement("tr");

        fila.innerHTML = `
            <td>${registro.curso}</td>
            <td>${registro.fecha}</td>
            <td>${registro.nombre}</td>
        `;

        tabla.appendChild(fila);
    });
}

function exportarExcel() {
    let historial = JSON.parse(localStorage.getItem("historial")) || [];

    if (historial.length === 0) {
        alert("No hay registros para generar el informe");
        return;
    }

    let datos = historial.map((r, index) => ({
        "NÂ°": index + 1,
        "Curso": r.curso,
        "Fecha": r.fecha,
        "Nombre": r.nombre
    }));

    let hoja = XLSX.utils.json_to_sheet(datos);
    let libro = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(libro, hoja, "Informe");

    XLSX.writeFile(libro, "informe_registro_curso.xlsx");
}
